---
title: "Instalaci√≥n y configuraci√≥n de minikube y kubectl"
---

## Minikube

* **Minikube** permite desplegar localmente un **cl√∫ster de Kubernetes de un solo nodo**.
* Es un **proyecto oficial de Kubernetes**, lo que garantiza:
  * Mantenimiento activo.
  * Compatibilidad con versiones actuales de k8s.
* Es una de las **mejores opciones para aprender Kubernetes**, porque:
  * Es un proyecto maduro.
  * Su instalaci√≥n y uso son sencillos.
* **Requisitos m√≠nimos del sistema** para instalar Minikube:
  * 2 CPUs.
  * 2 GiB de memoria RAM.
  * 20 GiB de espacio libre en disco.
* Es necesario disponer de un **sistema de virtualizaci√≥n o de contenedores**, en nuestro caso usaremos KVM.
* El cl√∫ster de Kubernetes que se usar√° en el curso ser√° **de un solo nodo**.
* Ese √∫nico nodo asumir√° **doble rol**:
  * **Master (control plane)**: ejecutando los componentes principales de Kubernetes.
  * **Worker**: ejecutando las cargas de trabajo en contenedores.
* **Minikube** es una herramienta que se instala como un **programa en la m√°quina anfitriona**.
* Al ejecutarse, Minikube crea una **m√°quina virtual Linux** con:
  * Kubernetes completamente configurado.
  * Un cl√∫ster funcional y listo para usar.
* Minikube puede instalarse en **Linux, Windows y macOS**.
* Es compatible con **varios sistemas de virtualizaci√≥n**, aunque no todos ofrecen la misma funcionalidad.
* Utilizaremos **Minikube sobre KVM**, aprovechando:
  * Virtualizaci√≥n nativa en Linux.
  * Mejor rendimiento y mayor integraci√≥n con el sistema anfitri√≥n.

## Instalaci√≥n de minikube en linux con KVM

Accedemos a
[https://minikube.sigs.k8s.io/docs/start/](https://minikube.sigs.k8s.io/docs/start/) y seleccionamos el m√©todo que prefiramos para instalar, eligiendo nuestro sistema operativo, arquitectura, etc.

Minikube se instala, como otras aplicaciones de Go, como un binario enlazado est√°ticamente (autoconsistente), que no tiene dependencias de nada y que tenemos que ubicar en alg√∫n directorio del PATH de nuestro
sistema. Veamos en particular la instalaci√≥n directa del binario en un
sistema linux:

Paso 1: Descargamos como usuario normal y con ayuda de la aplicaci√≥n curl, la √∫ltima versi√≥n del binario de minikube (en este caso para arquitectura x86-64):

    curl -LO https://storage.googleapis.com/minikube/releases/latest/minikube-linux-amd64

Paso 2: Movemos el binario a un directorio del PATH (lo recomendable en este caso ser√≠a /usr/local/bin/) y establecemos permisos de ejecuci√≥n. Todo esto puede hacerse con los comandos `mv` y `chmod`, o de forma m√°s sencilla con `install`

    sudo install minikube-linux-amd64 /usr/local/bin/minikube

Comprobamos que se ha instalado correctamente con:

    minikube version
    minikube version: v1.35.0

## Creaci√≥n del cl√∫ster de k8s

El siguiente paso consiste en lanzar minikube para que cree el cluster de Kubernetes de un solo nodo (master+worker). Minikube puede crear este cluster en diversos sistemas de virtualizaci√≥n o sobre docker, lo
recomendable es visitar la p√°gina de ["drivers"](https://minikube.sigs.k8s.io/docs/drivers/) y seleccionar el m√©todo m√°s adecuado para nuestro sistema.

De forma general, se crear√° el cl√∫ster de Kubernetes a trav√©s de minikube, mediante la instrucci√≥n:

    minikube start --driver=kvm2

Esto crear√° de forma autom√°tica una m√°quina virtual o un contenedor en el sistema escogido e instalar√° Kubernetes en ella. Por √∫ltimo, se configura `kubectl` si est√° instalado (el cliente de l√≠nea de comandos
de k8s) para que utilice el cluster reci√©n instalado. Podemos ver una salida t√≠pica de la instalaci√≥n del cluster a continuaci√≥n:

Podemos comprobar en cualquier momento el estado de minikube con la instrucci√≥n:

```
minikube status
minikube
type: Control Plane
host: Running
kubelet: Running
apiserver: Running
kubeconfig: Configured
```

## Parada y reinicio de minikube

Podemos parar y volver a arrancar minikube cuando sea preciso, ya que no se trata de un cl√∫ster de k8s en producci√≥n, sino de uno instalado en un equipo convencional. Esto se realiza mediante las instrucciones:

```
minikube stop
‚úã  Stopping node "minikube"  ...
üõë  1 nodes stopped.
```

```
minikube start
...
```

## V√≠deo

[https://www.youtube.com/watch?v=0l_NICnY7AI](https://www.youtube.com/watch?v=0l_NICnY7AI)

# Instalaci√≥n de kubectl en linux

**kubectl** es la herramienta de l√≠nea de comandos utilizada para interactuar con la API de Kubernetes. Es por tanto la herramienta fundamental que vamos a utilizar durante todo el curso para gestionar nuestros objetos en el cl√∫ster reci√©n creado con minikube.

Las instrucciones para su instalaci√≥n est√°n disponibles en la [documentaci√≥n de k8s](https://kubernetes.io/es/docs/tasks/tools/install-kubectl/). PAra nosotros la forma m√°s f√°cil:

```
sudo apt install kubernetes-client
```

El fichero donde se configura el cl√∫ster de kubernetes al que vamos a acceder lo encontramos en el fichero `~/.kube/config`.

Comprobamos que ya aparece la versi√≥n del servidor y por tanto se ha podido conectar con el cl√∫ster que gestiona minikube. Adem√°s podemos ejecutar nuestro primer comando propiamente de `kubectl`:

```
kubectl get nodes
NAME       STATUS   ROLES                  AGE   VERSION
minikube   Ready    control-plane,master   21m   v1.32.0
```

Si queremos utilizar el autocompletado, podemos generarlo e incorporarlo a nuestro entorno con:

```
echo 'source <(kubectl completion bash)' >> ~/.bashrc

# Para los usuarios de zsh:
kubectl completion zsh > ~/.kubectl-completion
```

Y para poder usarlo en esta misma sesi√≥n (no ser√° necesario m√°s adelante, ya que el fichero `.bashrc` se lee cada vez que se inicia una sesi√≥n):

```
source ~/.bashrc

# Para los usuarios de zsh:
source ~/.kubectl-completion
source ~/.zshrc
```

## V√≠deo

[https://www.youtube.com/watch?v=0p_JGucaSco](https://www.youtube.com/watch?v=0p_JGucaSco)

{% capture notice-text %}
## Ejercicio

Instala y configura minikube y kubectl para poder realizar el resto del curso.

Para comprobar que el ejercicio es correcto comprueba la salida de las siguientes instrucciones:

* La salida de `minikube status`.
* La salida de `kubectl get nodes -o wide`.

{% endcapture %}<div class="notice--warning">{{ notice-text | markdownify }}</div>